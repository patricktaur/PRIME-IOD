<!-- <p>third-party-tracker-edit works!</p> -->
<app-loader [isLoading]="true" *ngIf="loading"></app-loader>
<div *ngIf="taskGroupSelectVisible">
  <div class="row">
    <div class="col-3">
      <label class="form-label">Task Group</label>
    </div>
    <div class="col-9">
      <div class="form-group" [title]="taskGroupTitle">
        <ng-select
          [multiple]="false"
          [(ngModel)]="selectedTaskGroupId"
          [clearable]="true"
          (ngModelChange)="onTaskGroupChange()"
          [disabled]="form.dirty"
        >
          <ng-option *ngFor="let rec of taskGroups" [value]="rec.id">{{ rec.value }}</ng-option>
        </ng-select>
      </div>
    </div>
  </div>
  <hr />
</div>
<form [formGroup]="form" (ngSubmit)="submit()">
  <formly-form [model]="record" [fields]="fields" [options]="options" [form]="form"></formly-form>
  <div class="alert alert-warning" role="alert" *ngIf="cppcNumberExists">
    CPPC Number is already in use.
  </div>

  <button *ngIf="hasDMManagerRole"
    type="submit"
    class="btn btn-primary submit-button me-1"
    [disabled]="!(form.valid && form.dirty) || cppcNumberExists"
  >
    Save
  </button>
  <button type="button" class="btn btn-default me-1" (click)="options.resetModel()">Undo</button>
  <!-- <span class="alert alert-info">Last Updated on: {{ record?.updatedOn | date: 'd-MMM-y, h:mm a' }}</span> -->
  <app-last-saved [auditFields]="record"></app-last-saved>

</form>

<!-- <p>record: {{ record | json }}</p> -->
<!-- <p>cppcNumberExists: {{cppcNumberExists}}</p> -->
